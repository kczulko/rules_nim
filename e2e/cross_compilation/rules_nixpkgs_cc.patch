diff --git a/MODULE.bazel b/MODULE.bazel
index dfe0fc7..fdf8b9d 100644
--- a/MODULE.bazel
+++ b/MODULE.bazel
@@ -5,4 +5,4 @@ module(
 
 bazel_dep(name = "rules_nixpkgs_core", version = "0.13.0")
 bazel_dep(name = "bazel_skylib", version = "1.0.3")
-bazel_dep(name = "rules_cc", version = "0.0.1")
+bazel_dep(name = "rules_cc", version = "0.2.16")
diff --git a/cc.bzl b/cc.bzl
index 5c28f41..fdbd46c 100644
--- a/cc.bzl
+++ b/cc.bzl
@@ -22,13 +22,11 @@ using `nixpkgs_cc_configure(..., cc_lang = "cuda")` or similar.
 
 load("@bazel_skylib//lib:sets.bzl", "sets")
 load("@bazel_tools//tools/build_defs/repo:utils.bzl", "maybe")
-load(
-    "@rules_nixpkgs_core//private/cc_toolchain:lib_cc_configure.bzl",
-    "get_cpu_value",
-    "get_starlark_list",
-    "write_builtin_include_directory_paths",
+load("@rules_cc//cc/private/toolchain:lib_cc_configure.bzl",
+     "get_cpu_value",
+     "get_starlark_list",
+     "write_builtin_include_directory_paths",
 )
-
 load("@rules_nixpkgs_core//:nixpkgs.bzl", "nixpkgs_package")
 load(
     "@rules_nixpkgs_core//:util.bzl",
diff --git a/cc.bzl b/cc.bzl
index fdbd46c..5ca7ff0 100644
--- a/cc.bzl
+++ b/cc.bzl
@@ -238,22 +238,22 @@ _nixpkgs_cc_toolchain_config = repository_rule(
         "fail_not_supported": attr.bool(),
         "cross_cpu": attr.string(),
         "_unix_cc_toolchain_config": attr.label(
-            default = Label("@rules_nixpkgs_core//private/cc_toolchain:unix_cc_toolchain_config.bzl"),
+            default = Label("@rules_cc//cc/private/toolchain:unix_cc_toolchain_config.bzl"),
         ),
         "_armeabi_cc_toolchain_config": attr.label(
-            default = Label("@rules_nixpkgs_core//private/cc_toolchain:armeabi_cc_toolchain_config.bzl"),
+            default = Label("@rules_cc//cc/private/toolchain:armeabi_cc_toolchain_config.bzl")
         ),
         "_generate_system_module_map": attr.label(
-            default = Label("@rules_nixpkgs_core//private/cc_toolchain:generate_system_module_map.sh"),
+            default = Label("@rules_cc//cc/private/toolchain:generate_system_module_map.sh")
         ),
         "_osx_cc_wrapper": attr.label(
-            default = Label("@rules_nixpkgs_core//private/cc_toolchain:osx_cc_wrapper.sh.tpl"),
+            default = Label("@rules_cc//cc/private/toolchain:osx_cc_wrapper.sh.tpl")
         ),
         "_linux_cc_wrapper": attr.label(
-            default = Label("@rules_nixpkgs_core//private/cc_toolchain:linux_cc_wrapper.sh.tpl"),
+            default = Label("@rules_cc//cc/private/toolchain:linux_cc_wrapper.sh.tpl")
         ),
         "_build": attr.label(
-            default = Label("@rules_nixpkgs_core//private/cc_toolchain:BUILD.tpl"),
+            default = Label("@rules_cc//cc/private/toolchain:BUILD.tpl")
         ),
     },
 )
diff --git a/cc.bzl b/cc.bzl
index 5ca7ff0..cdf9056 100644
--- a/cc.bzl
+++ b/cc.bzl
@@ -228,6 +228,8 @@ def _nixpkgs_cc_toolchain_config_impl(repository_ctx):
             "%{supports_start_end_lib}": repr(info.supports_start_end_lib),
             "%{extra_flags_per_feature}": "{}",
             "%{conly_flags}": get_starlark_list(info.conly_flags),
+            "%{fastbuild_compile_flags}": "",
+            "%{all_compile_flags}": "",
         },
     )
 
